<tagLib name="cx,html,myhtml" />
<include file="../Public/header" />
<!-- 主体内容  -->
<script >

function showviewmaodel(){
	var tbid=$('viewtableid').value;
	$('view'+tbid).style.display='block';
}

function hideviewmaodel(id){
	if(id==''){
		var tbid=$('viewtableid').value;
	}else{
		var tbid=id;
	}
	$('view'+tbid).style.display='none';
}

var conditionvar=0;
var conditiontid=0;//条件
var conditionHTML='';//写入的内容

function setcon(tid,fid,ft){
	var showconditon=$("showconditon").innerHTML;
	if(tid!=conditiontid){
		if(conditionvar==0){
			$("showtips").value="请选择另一个表的表应的表";
			$("showtips").className="button_em0";
			conditionvar=fid;
			conditiontid=tid;
			conditionHTML=ft;
		}else{
			$("showtips").value="完成视图";
			$("showtips").className="button_em1";
			conditionvar=0;	
			conditiontid=0;	
			showHTML="<li >"+conditionHTML+"="+ft+" </li>";
			$("showconditon").innerHTML=showconditon + "<li> "+showHTML+" </li>";
		}
		
		$("tr"+tid+fid).className="tr1";
		
	}else{
		alert('你不能在本表内关联!');
	}
}

</script>
<form method="POST" action="__URL__/insert/" target="_self"  autocomplete='off' >
<fieldset>
<legend>增加视图模型数据</legend>
<table  bgcolor="White">
<tr >
<myhtml:labelinput  name="caption" label="标题[中文]" value="" type="text" size='10' />
<myhtml:labelinput  name="title" label="视图名[英文]" value="" type="text" size='10'/>
<myhtml:labelinput  name="infos" label="说明" value="" type="text" size='40'/>
<myhtml:labelinput  name="seqNo" label="排序" value="" type="text" size='2'/>
</tr>
</table>
</fieldset>
<fieldset>
<select id="viewtableid">
<volist name="table" id="table">
<option value="{$table.id}">{$table.caption}[{$table.title}]</option>
</volist>
</select>
<input type="button"  onclick="showviewmaodel();" class="button1" value="显示数据表">
<input type="button"  onclick="hideviewmaodel('');" class="button1" value="隐藏数据表">
<input type="button"  id='showtips'  value="提示" class="button_em1">
</fieldset>
<fieldset>
<legend>当前数据表</legend>
<ul  class="viewmodel">
<volist name="table_view" id="vo">
	<li id="view{$vo.id}" style="display:none;margin:1px;" >
		<table border="0" cellpadding="0" cellspacing="0"  class="list">
			<tr >
				<th colspan="2"  align="left">{$vo.caption}[{$vo.title}]</th>
				<th >名称</th>
				<th align="right"><a onclick="hideviewmaodel('{$vo.id}');" href="#">×</a></th>
			</tr>	
		<volist name="vo['sub']" id="sub">
			<tr id="tr{$vo.id}{$sub.id}">
				<td><input type="checkbox"  id="f{$vo.id}{$sub.id}"></td>
				<td><label for='f{$vo.id}{$sub.id}'>{$sub.caption}[{$sub.name}]</label></td>
				<td><input size="8" value="{$sub.name}" ></td>
				<td><a onclick="setcon('{$vo.id}','{$sub.id}','{$vo.title}.{$sub.name}');" href="#" title="设定条件">↓</a></td>
			</tr>
		</volist>
		</table>
	</li>
</volist>
</ul>
</fieldset>
<fieldset>
<legend>当前视图的条件</legend>
<ul  class="viewcondition" id="showconditon">
</ul>
</fieldset>
</form>
<input type="submit"  class="button1" value="确定增加数据">

<include file="../Public/footer" />
